version: '2'
services:
  app:
    build: .
    restart: always

    ports:
      - '3000:3000'

    volumes:
      - ./bin:/opt/democracy.io/bin
      - ./config:/opt/democracy.io/config
      - ./gulp:/opt/democracy.io/gulp
      - ./models:/opt/democracy.io/models
      - ./server:/opt/democracy.io/server
      - ./test:/opt/democracy.io/test
      - ./www:/opt/democracy.io/www

    environment:
      NODE_ENV: production

      REDIS_HOST: redis

      # Fill in with values from bin/gen-creds.js
      SESSION_SECRET:
      IP_SALT:

      POTC_BASE_URL: https://congressforms.eff.org
      POTC_DEBUG_KEY:

      SMARTY_STREETS_ID:
      SMARTY_STREETS_TOKEN:

      EFF_CIVIC_CRM_SITE_KEY:

  redis:
    image: redis
